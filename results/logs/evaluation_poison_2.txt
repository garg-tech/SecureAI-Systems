[INFO] Using device: cpu
[INFO] Loaded clean model mnist_custom_cnn.pth
[INFO] Loaded 10000 images from t10k-images.idx3-ubyte
[INFO] Loaded 10000 labels from t10k-labels.idx1-ubyte

===== CLEAN DATA EVALUATION =====
Accuracy on clean test set: 98.99%
Loss on clean test set:     0.0303

[INFO] Running FGSM attack with eps = 0.25
[INFO] FGSM generation time: 6.2513 seconds

===== ADVERSARIAL DATA EVALUATION =====
Accuracy on adversarial set: 43.65%
Loss on adversarial set:     2.1271

===== ATTACK SUCCESS RATE =====
Attack success rate: 55.90%

===== CONFUSION MATRIX (Adversarial) =====
[[663   1  52   1   5  12 111   2  81  52]
 [  0 454  41  18  89   5  16 148 334  30]
 [ 29  28 584  56  21   1   9 112 189   3]
 [  8   1 124 400   2 164  12  58 164  77]
 [  7   1  15   0 360   1  35  11  97 455]
 [ 17   2  12 104   0 103  49   4 288 313]
 [124   4  11   1  35  33 541   1 208   0]
 [  4  20  97  45  22   4   0 598  49 189]
 [ 28   2 177  15  20  36  32  30 571  63]
 [ 16   3  17   7 346  36   1 324 168  91]]

===== CLASSIFICATION REPORT (Adversarial) =====
              precision    recall  f1-score   support

           0     0.7400    0.6765    0.7068       980
           1     0.8798    0.4000    0.5500      1135
           2     0.5168    0.5659    0.5402      1032
           3     0.6182    0.3960    0.4828      1010
           4     0.4000    0.3666    0.3826       982
           5     0.2608    0.1155    0.1601       892
           6     0.6712    0.5647    0.6134       958
           7     0.4643    0.5817    0.5164      1028
           8     0.2657    0.5862    0.3657       974
           9     0.0715    0.0902    0.0798      1009

    accuracy                         0.4365     10000
   macro avg     0.4888    0.4343    0.4398     10000
weighted avg     0.4958    0.4365    0.4436     10000
